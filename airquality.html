<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="aparcaslogo.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Aparcas Project</title>

    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0,
    user-scalable=0' name='viewport' />


    <script src="bower_components/jquery/dist/jquery.js"></script>
    <script src="bower_components/jquery-ui/jquery-ui.js"></script>




    <script type="text/javascript" src="bower_components/moment/min/moment.min.js"></script>

    <script type="text/javascript" src="bower_components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>

    <link href="assets/css/style.css" rel="stylesheet" />


    <script src="bower_components/chart.js/dist/Chart.bundle.js"></script>
    <script src="bower_components/chart.js/samples/utils.js"></script>



    <!-- Bootstrap core CSS     -->
    <link href="bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet" />
    <!-- Animation library for notifications   -->
    <link href="bower_components/bootstrap/dist/css/animate.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="bower_components/jquery/src/css/jquery-ui.css">

    <link rel="stylesheet" href="bower_components/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css" />
    <link href="https://fonts.googleapis.com/css?family=Mitr" rel="stylesheet">




    <!--  -->

    <style type="text/css">
        html,
        body {
            margin-left: auto;
            margin-right: auto;
            font-family: 'Mitr', sans-serif;
            margin: auto;
            position: relative;
            padding: 0 0 0 0;
            height: 100%;
            width: 100%;
        }

        #map {
            position: relative;
            width: 100%;
            height: 88vh;
            margin: 0;
            padding: 0;
        }

        th {
            padding: 0px 0px 0px 50px;
        }

        .modal-body {
            position: relative;
            overflow-y: auto;
            max-height: 400px;
            padding: 15px;
        }

        #legend {
            background: #FFF;
            padding: 10px;
            margin: 5px;
            font-size: 12px;
            font-family: Arial, sans-serif;
        }

        .color {
            border: 1px solid;
            height: 12px;
            width: 12px;
            margin-right: 3px;
            float: left;
        }

        .blue {
            background: #4d4dff;
        }

        .green {
            background: #4dff88;
        }

        .yellow {
            background: #ffff4d;
        }

        .orange {
            background: #ff944d;
        }

        .red {
            background: #ff4d4d;
        }

        #full-width {
            padding: inherit;
        }
    </style>
</head>

<body>
    <header>
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-12">
                    <h4><strong>Air Pollution and Radioactive Contamination Analyzing System (APARCAS)</strong> &nbsp;&nbsp;</h4>

                </div>

            </div>
        </div>
    </header>
    <section class="menu-section">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <ul id="menu-top" class="nav navbar-nav navbar-right">
                        <li><a href="realtime.html">คุณภาพอากาศแบบเรียลไทม์</a></li>
                        <li><a href="radioactive.html">ประวัติปริมาณกัมมันตรังสี</a></li>
                        <li><a class="menu-top-active" href="airquality.html">ประวัติคุณภาพอากาศ</a></li>
                        <li><a href="directions.html">ค้นหาเส้นทางหลีกเลี่ยงมลพิษ</a></li>
                        <!-- <li><a href="predict.html">พยากรณ์คุณภาพอากาศ</a></li> -->
                        <li><a href="aqi.html">ดัชนีคุณภาพอากาศ</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </section>





    <div id="full-width" class="container-fluid">
        <div class="row">
            <div class="col-sm-7">
                <div id="map"></div>

            </div>
            <div class="col-sm-5">
                <br>


                <h4 class="text-center text-primary">กรุณาเลือกพื้นที่และวันที่เพื่อแสดงข้อมูล</h4>


                <from>
                    <div class="form-group">
                        <h5 class=" col-sm-1 col-sm-offset-2 text-info">จังหวัด:</h5>
                        <div class="col-sm-6 ">

                            <div class="dropdown">
                                <button id="pname" class="btn btn-info dropdown-toggle" style="width: 100%;  font-size:14px " type="button" data-toggle="dropdown">
                    <span class="caret"></span></button>
                                <ul id="dropdownP" class="dropdown-menu" role="menu" style="width: 356px">
                                    <!-- <li selected="selected"><a href='#' data-value='10'>กรุงเทพมหานคร</a></li> -->
                                </ul>
                            </div>


                        </div>
                    </div>
                    <br><br><br>
                    <div class="form-group">
                        <h5 class="col-sm-1 col-sm-offset-2 text-info">เขต:</h5>
                        <div class="col-sm-6">
                            <div class="dropdown">
                                <button id="dname" class="btn btn-info dropdown-toggle" style="width: 100%;  font-size:14px " type="button" data-toggle="dropdown">คลิ๊กที่นี่ เพื่อเลือกเขต
                      <span class="caret"></span></button>
                                <ul id="dropdownD" class="dropdown-menu" style="width: 356px">


                                </ul>

                            </div>
                        </div>
                    </div>
                    <br>
                    <br>
                    <br>
                    <div class="form-group">
                        <h5 class="col-sm-1  col-sm-offset-2 text-info">แขวง:</h5>
                        <div class="col-sm-6">
                            <div class="dropdown">
                                <button id="sname" class="btn btn-info dropdown-toggle" style="width: 100%;  font-size:14px " type="button" data-toggle="dropdown">คลิ๊กที่นี่ เพื่อเลือกแขวง
                        <span class="caret"></span></button>
                                <ul id="dropdownS" class="dropdown-menu" style="width: 356px">


                                </ul>

                            </div>
                        </div>
                    </div>

                    <br><br>
                    <br>
                    <div class="form-group">
                        <h5 class="col-sm-1 col-sm-offset-2 text-info">วัน:</h5>
                        <div class="col-sm-6">
                            <!-- <input class="form-control" id="txtDate" placeholder="Pick your Date"/> -->
                            <input id="txtDate" type='text' class="form-control" placeholder="คลิ๊กที่นี่เพื่อเลือกวัน" style="width: 100%;" />
                        </div>
                    </div>
                    <br>
                    <br>

                    <div class="form-group col-sm-offset-3">

                        <div class="col-sm-4">
                            <button type="button" id="Search" class="btn btn-lg btn-success btn-block">แสดงข้อมูล</button>
                        </div>

                        <div class="col-sm-4">
                            <button id="clear" type="button" class="btn btn-lg btn-danger btn-block">ล้าง</button>
                        </div>

                    </div>
                    </form>

                    <br>
                    <br>
                    <br>
                    <h4 class="text-primary text-center" style="">คำอธิบายสัญลักษณ์ เกณฑ์ของดัชนีคุณภาพอากาศ</h4>

                    <div clsss="col-sm-1">
                        <div class="row">
                            <div class="container" style="width : 90%;">
                                <table class="table table-hover table-bordered">
                                    <thead>
                                        <th style="background-color: #ff4d4d">
                                            <h5><b>สัญลักษณ์</b></h5>
                                        </th>
                                        <th style="background-color: #ff4d4d">
                                            <h5><b>AQI</b></h5>
                                        </th>
                                        <th style="background-color: #ff4d4d">
                                            <h5><b>คำอธิบาย</b></h5>
                                        </th>



                                    </thead>
                                    <tbody>
                                        <tr style="background-color:#CFD9C8">
                                            <td>
                                                <canvas id="blue" width="40" height="40" style="border:2px solid #000000;"></td>
                                  <td>0-50</td>
                                  <td>คุณภาพดี</td>


                                </tr>
                                <tr style="background-color:#CFD9C8">
                                  <td>
                                    <canvas id="green" width="40" height="40" style="border:2px solid #000000;"></td>
                                      <td>51-100</td>
                                      <td>คุณภาพปานกลาง</td>


                                    </tr>
                                    <tr style="background-color:#CFD9C8">

                                      <td>
                                        <canvas id="yellow" width="40" height="40" style="border:2px solid #000000;"></td>
                                          <td>100-200</td>
                                          <td>มีผลกระทบต่อสุขภาพ</td>


                                        </tr>
                                        <tr style="background-color:#CFD9C8">
                                          <td>
                                            <canvas id="orange" width="40" height="40" style="border:2px solid #000000;"></td>
                                              <td>201-300</td>
                                              <td>มีผลกระทบต่อสุขภาพมาก</td>


                                            </tr>
                                            <tr style="background-color:#CFD9C8">
                                              <td>
                                                <canvas id="red" width="40" height="40" style="border:2px solid #000000;"></td>
                                                  <td>มากกว่า 300</td>
                                                  <td>อันตราย</td>

                                                </tr>

                                              </tbody>
                                            </table>
                                          </div>


                                        </div>
                                      </div>
                                    </div>




                                      <!-- Modal -->
                                      <div id="myModal" class="modal fade" role="dialog">
                                        <div class="modal-dialog">

                                          <!-- Modal content-->
                                          <div class="modal-content">
                                            <div class="modal-header">
                                              <button type="button" class="close" data-dismiss="modal">&times;</button>
                                              <h4 class="modal-title">Modal Header</h4>
                                            </div>
                                            <div class="modal-body">
                                              <canvas id="canvas"></canvas>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                        </div>

                    </div>
            </div>


</body>






<script type="text/javascript" charset="utf-8">
    var FusionTable = [];
    var KmlLayer = [];
    var haveChart = false;

    var markers = [];
    var allS = [];

    // $(".selectpicker").selectpicker({
    //   style: 'btn-info',
    //   size: 16,
    //   width: '356px'
    //   //  style="width: 356px;  font-size:14px " type="button" data-toggle="dropdown">
    //
    //
    // });
    var blue = document.getElementById("blue");
    var ctx = blue.getContext("2d");
    ctx.fillStyle = '#b3e0ff';
    ctx.fillRect(0, 0, 80, 80);
    var blue = document.getElementById("green");
    var ctx = blue.getContext("2d");
    ctx.fillStyle = '#c2f0c2';
    ctx.fillRect(0, 0, 80, 80);
    var blue = document.getElementById("yellow");
    var ctx = blue.getContext("2d");
    ctx.fillStyle = '#ffffb3';
    ctx.fillRect(0, 0, 80, 80);
    var blue = document.getElementById("orange");
    var ctx = blue.getContext("2d");
    ctx.fillStyle = '#ffd9b3';
    ctx.fillRect(0, 0, 80, 80);
    var blue = document.getElementById("red");
    var ctx = blue.getContext("2d");
    ctx.fillStyle = '#ffcccc';
    ctx.fillRect(0, 0, 80, 80);


    $("#dropdownD").click(function() {


    });
    $(".dropdown-menu li a ").click(function() { // show value when click
        $(this).parents(".dropdown").find('.btn').html($(this).text());
        $(this).parents(".dropdown").find('.btn').val($(this).data('value'));
    });


    $.getJSON("http://sysnet.utcc.ac.th/aparcas/api/grid_lut.jsp", function(result) {

        var checkSame = ['55'];
        var count = 1;
        var districtname;

        var query = "<li ><a href='#'data-value='2222'>เขตทั้งหมด</a></li>";
        $("#dropdownD").append(query);
        for (i = 0; i < result.length; i++) {

            districtname = result[i].dname;
            var districtcode = result[i].dcode;

            for (j = 0; j < checkSame.length; j++) {
                if (checkSame[j] == districtcode) {
                    count = 0;
                    break;
                }
            }
            if (count == 1) {
                var query = "<li ><a href='#' data-value='" + districtcode + "'>" + districtname + "</a></li>";
                $("#dropdownD").append(query);
                checkSame.push(districtcode);
            }
            count = 1;

        } //for

        $(".dropdown-menu li a").click(function() { // show value when click
            $("#dropdownS").empty();
            $("#sname").text('คลิ๊กที่นี่ เพื่อเลือกแขวง');
            document.getElementById("sname").value = "";
            $(this).parents(".dropdown").find('.btn').html($(this).text());
            $(this).parents(".dropdown").find('.btn').val($(this).data('value'));

            allS = null;
            allS = [];
            var query = "<li ><a href='#'data-value='2222'>แขวงทั้งหมด</a></li>";
            $("#dropdownS").append(query);

            var dname = document.getElementById("dname").innerHTML;
            var checkSame2 = ['55555'];
            var count2 = 1;

            console.log("dname: " + dname);

            for (i = 0; i < result.length; i++) {
                var sname = result[i].sname;
                var scode = result[i].scode;
                for (j = 0; j < checkSame.length; j++) {

                    if (checkSame2[j] == sname) {
                        count2 = 0;
                        break;
                    }
                }
                if (result[i].dname == dname) {
                    if (count2 == 1) {
                        console.log("DNAME: " + dname + " Sname: " + sname);
                        checkSame2.push(sname);
                        var query = "<li ><a href='#'data-value='" + scode + "'>" + sname + "</a></li>";
                        $("#dropdownS").append(query);
                        allS.push(scode);

                    }
                    count2 = 1;
                }
            }
            $(".dropdown-menu li a").click(function() { // show value when click
                $(this).parents(".dropdown").find('.btn').html($(this).text());
                $(this).parents(".dropdown").find('.btn').val($(this).data('value'));
            });

        });

    });



    function initMap() {



        $('#Search').click(function() {

            $("#showInfo").empty();
            var mDate = document.getElementById("txtDate").value; //time
            var dname = document.getElementById("dname").value;
            var sname = document.getElementById("sname").value;
            var pname = document.getElementById("pname").value;


            //var mDistrict = document.getElementById("mDistrict").value;//district
            if (pname == "") {
                getNotification("pe-7s-close-circle", "danger", "<b>Error</b> กรุณาเลือกจังหวัด");
            } else if (dname == "" && pname != "") {
                getNotification("pe-7s-close-circle", "danger", "<b>Error</b> กรุณาเลือกเขต");
            } else if (sname == "" && pname != "" && dname != "") {
                getNotification("pe-7s-close-circle", "danger", "<b>Error</b> กรุณาเลือกแขวง");
            } else if (mDate == "" && pname != "" && sname != "" && dname != "") {
                getNotification("pe-7s-close-circle", "danger", "<b>Error</b> กรุณาเลือกวัน");
            } else {

                waitingDialog.show('Loading...');
                console.log('mdate: ' + mDate);

                setDataOnMap(mDate, dname, sname);
            }
            //});//getJSON
        }); //date Click
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 11,
            center: new google.maps.LatLng(13.756331, 100.501765),
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }); //end of map





        function setDataOnMap(date, dname, sname) {

            RemoveMarker();
            var good = [];
            var mModerate = [];
            var Unhealthy1 = [];
            var Unhealthy2 = [];
            var Unhealthy3 = [];

            mydate = date;
            var mDate = DatePickResponse(mydate);
            var check = false;
            console.log("date: " + date + " mdate: " + mDate);

            // $("#showInfo").append("<div class='col-md-12'><h5 class = 'text-info text-center'>ค้นหาเขต: " + mDate + "</h5></div>");

            $.getJSON("http://sysnet.utcc.ac.th/aparcas/api/event_trans.jsp", function(result) {

                var co = [];
                var no2 = [];
                var o3 = [];
                var so2 = [];
                var pm25 = [];
                var radio = [];
                var lat = [];
                var lon = [];
                var count = new Array(9000).fill(0);

                var re = new RegExp(mDate, 'g');

                var check = 0;
                var m = 0;
                var sid = document.getElementById("sname").value;
                var did = document.getElementById("dname").value;
                var dname = document.getElementById("dname").innerHTML;
                var sname = document.getElementById("sname").innerHTML;
                if (did != 1111 && sid != 2222) {
                    console.log("Some Sub_code");
                    for (i = 0; i < result.length; i++) {
                        var day = moment.unix(result[i].timestamp).format("YYYY-MM-DD HH:mm:ss");
                        if (day.match(re)) {
                            if (sid == result[i].grid_id) {


                                var disID = parseInt(result[i].grid_id);
                                if (count[disID] != 0) {

                                    co[disID] = co[disID] + parseInt(result[i].co);
                                    no2[disID] = no2[disID] + parseInt(result[i].no2);
                                    o3[disID] = o3[disID] + parseInt(result[i].o3);
                                    so2[disID] = so2[disID] + parseInt(result[i].so2);
                                    pm25[disID] = pm25[disID] + parseInt(result[i].pm25);
                                    radio[disID] = radio[disID] + parseInt(result[i].radio);
                                    count[disID] = count[disID] + 1;
                                    console.log("Num2");
                                }
                                if (count[disID] == 0) {
                                    co[disID] = +parseInt(result[i].co);
                                    no2[disID] = +parseInt(result[i].no2);
                                    o3[disID] = +parseInt(result[i].o3);
                                    so2[disID] = +parseInt(result[i].so2);
                                    pm25[disID] = +parseInt(result[i].pm25);
                                    radio[disID] = +parseInt(result[i].radio);
                                    count[disID] = +1;
                                    console.log("Num");
                                }
                                check = true;


                                console.log("Time: " + mDate + " District: " + disID + " co: " + co[disID] + " no2: " + no2[disID] + " o3: " + o3[disID] + " so2: " + so2[disID] + " pm25: " + pm25[disID] + " radio: " + radio[disID] +
                                    " count: " + count[disID]);
                            }


                        } //end if
                    } // end for
                    if (check == false) {
                        getNotification("pe-7s-close-circle", "danger", "<b>Error</b> ไม่พบข้อมูล");
                    } else {
                        var districtLayer = new google.maps.KmlLayer({
                            url: 'http://sysnet.utcc.ac.th/aparcas/data/simplified.kml',
                            map: map
                        });
                        KmlLayer.push(districtLayer);
                        var geocoder = new google.maps.Geocoder();
                        geocoder.geocode({
                            'address': sname
                        }, function(results, status) {
                            if (status == google.maps.GeocoderStatus.OK) {
                                map.setCenter(results[0].geometry.location);
                                map.setZoom(13);
                            }
                        });
                        getNotification("pe-7s-smile", "success", "<b>กดที่จุดแผนที่ที่ต้องการเพื่อดูข้อมูล</b>");
                    }

                }
                if (sid == 2222 && did != 2222) {
                    console.log("all Sub_code");
                    console.log("AllS: " + allS.length);
                    for (j = 0; j < allS.length; j++) {
                        for (i = 0; i < result.length; i++) {
                            var day = moment.unix(result[i].timestamp).format("YYYY-MM-DD HH:mm:ss");
                            if (day.match(re)) {
                                if (allS[j] == result[i].grid_id) {
                                    var disID = parseInt(result[i].grid_id);

                                    if (count[disID] != 0) {
                                        co[disID] = co[disID] + parseInt(result[i].co);
                                        no2[disID] = no2[disID] + parseInt(result[i].no2);
                                        o3[disID] = o3[disID] + parseInt(result[i].o3);
                                        so2[disID] = so2[disID] + parseInt(result[i].so2);
                                        pm25[disID] = pm25[disID] + parseInt(result[i].pm25);
                                        radio[disID] = radio[disID] + parseInt(result[i].radio);
                                        count[disID] = count[disID] + 1;
                                        console.log("Num2");
                                    }
                                    if (count[disID] == 0) {
                                        co[disID] = +parseInt(result[i].co);
                                        no2[disID] = +parseInt(result[i].no2);
                                        o3[disID] = +parseInt(result[i].o3);
                                        so2[disID] = +parseInt(result[i].so2);
                                        pm25[disID] = +parseInt(result[i].pm25);
                                        radio[disID] = +parseInt(result[i].radio);
                                        count[disID] = +1;
                                        console.log("Num");

                                    }
                                    check = true;
                                }
                            }
                        }
                    }
                    if (check == false) {
                        getNotification("pe-7s-close-circle", "danger", "<b>Error</b> ไม่พบข้อมูล");
                    } else {
                        var districtLayer = new google.maps.KmlLayer({
                            url: 'http://sysnet.utcc.ac.th/aparcas/data/simplified.kml',
                            map: map
                        });
                        KmlLayer.push(districtLayer);
                        var geocoder = new google.maps.Geocoder();
                        geocoder.geocode({
                            'address': dname
                        }, function(results, status) {
                            if (status == google.maps.GeocoderStatus.OK) {
                                map.setCenter(results[0].geometry.location);
                                map.setZoom(13);
                            }
                        });
                        getNotification("pe-7s-smile", "success", "<b>กดที่จุดแผนที่ที่ต้องการเพื่อดูข้อมูล</b>");
                    }
                }
                if (did == 2222 && sid == 2222) {
                    console.log("All district ");
                    for (i = 0; i < result.length; i++) {
                        var day = moment.unix(result[i].timestamp).format("YYYY-MM-DD HH:mm:ss");
                        if (day.match(re)) {
                            var disID = parseInt(result[i].grid_id);
                            if (count[disID] != 0) {
                                co[disID] = co[disID] + parseInt(result[i].co);
                                no2[disID] = no2[disID] + parseInt(result[i].no2);
                                o3[disID] = o3[disID] + parseInt(result[i].o3);
                                so2[disID] = so2[disID] + parseInt(result[i].so2);
                                pm25[disID] = pm25[disID] + parseInt(result[i].pm25);
                                radio[disID] = radio[disID] + parseInt(result[i].radio);
                                count[disID] = count[disID] + 1;
                                console.log("Num2");
                            }
                            if (count[disID] == 0) {
                                co[disID] = +parseInt(result[i].co);
                                no2[disID] = +parseInt(result[i].no2);
                                o3[disID] = +parseInt(result[i].o3);
                                so2[disID] = +parseInt(result[i].so2);
                                pm25[disID] = +parseInt(result[i].pm25);
                                radio[disID] = +parseInt(result[i].radio);
                                count[disID] = +1;
                                console.log("Num");

                            }
                            check = true;
                        }
                    }
                    if (check == false) {
                        getNotification("pe-7s-close-circle", "danger", "<b>Error</b> ไม่พบข้อมูล");
                    } else {
                        var districtLayer = new google.maps.KmlLayer({
                            url: 'http://sysnet.utcc.ac.th/aparcas/data/simplified.kml',
                            map: map
                        });
                        KmlLayer.push(districtLayer);
                        // var geocoder = new google.maps.Geocoder();
                        // geocoder.geocode({
                        //     'address': "กรุงเทพมหานคร"
                        // }, function(results, status) {
                        //     if (status == google.maps.GeocoderStatus.OK) {
                        map.setCenter(new google.maps.LatLng(13.756331, 100.501765)); //bangkok
                        map.setZoom(11);
                        //     }
                        // });
                        getNotification("pe-7s-smile", "success", "<b>กดที่จุดแผนที่ที่ต้องการเพื่อดูข้อมูล</b>");
                    }
                }

                var newDisrict = [];
                var newCO = [];
                var newNO2 = [];
                var newO3 = [];
                var newSO2 = [];
                var newPM25 = [];
                var newRadio = [];
                var newAQI = []
                var newlat = [];
                var newLon = [];
                for (i = 0; i < co.length; i++) {
                    if (co[i] != null) {
                        console.log("count[i]: " + count[i] + " i: " + i);
                        console.log("before divide: " + "co: " + co[i] + " no2: " + no2[i]);
                        var resCO = co[i] / count[i];
                        var resNO2 = no2[i] / count[i];
                        var resO3 = o3[i] / count[i];
                        var resSO2 = so2[i] / count[i];
                        var resPM25 = pm25[i] / count[i];
                        var resRadio = radio[i] / count[i];


                        console.log("after divide: " + "co: " + resCO + " no2: " + resNO2);

                        resCO = resCO.toFixed(2);
                        resNO2 = resNO2.toFixed(2);
                        resO3 = resO3.toFixed(2);
                        resSO2 = resSO2.toFixed(2);
                        resPM25 = resPM25.toFixed(2);
                        resRadio = resRadio.toFixed(2);
                        co[i] = resCO;
                        no2[i] = resNO2;
                        o3[i] = resO3;
                        so2[i] = resSO2;
                        pm25[i] = resPM25;
                        radio[i] = resRadio;
                        var aqina = Math.max(resCO, resNO2, resO3, resSO2, resPM25);



                        newDisrict.push(i);
                        newCO.push(resCO);
                        newO3.push(resO3);
                        newSO2.push(resSO2);
                        newNO2.push(resNO2);
                        newPM25.push(resPM25);
                        newRadio.push(resRadio);
                        newAQI.push(aqina);
                    }
                }
                for (i = 0; i < newDisrict.length; i++) {

                    console.log("newDistrictID: " + newDisrict[i] + " AQI: " + newAQI[i] + " CO: " + newCO[i] + " NO2: " + newNO2[i] + " O3: " + newO3[i] + " so2: " + newSO2[i] + " PM2.5: " + newPM25[i] + " Radio: " + newRadio[i]);

                    if (newAQI[i] > 0 && newAQI[i] < 51) {
                        good.push(newDisrict[i]);
                    }
                    if (newAQI[i] > 50 && newAQI[i] < 99) {
                        mModerate.push(newDisrict[i]);
                    }
                    if (newAQI[i] > 100 && newAQI[i] < 199) {
                        Unhealthy1.push(newDisrict[i]);
                    }
                    if (newAQI[i] > 200 && newAQI[i] < 299) {
                        Unhealthy2.push(newDisrict[i]);
                    }
                    if (newAQI[i] > 300) {
                        Unhealthy3.push(newDisrict[i]);
                    }

                }

                console.log("Good.length: " + good.length);
                for (i = 0; i < good.length; i++) {
                    console.log("Good: " + good[i]);
                }

                console.log("mModerate.length: " + mModerate.length);
                for (i = 0; i < mModerate.length; i++) {
                    console.log("mModerate: " + mModerate[i]);
                }

                console.log("Unhealthy1.length: " + Unhealthy1.length);
                for (i = 0; i < Unhealthy1.length; i++) {
                    console.log("Unhealthy1: " + Unhealthy1[i]);
                }

                console.log("Unhealthy2.length: " + Unhealthy2.length);
                for (i = 0; i < Unhealthy2.length; i++) {
                    console.log("Unhealthy2: " + Unhealthy2[i]);
                }

                console.log("Unhealthy3.length: " + Unhealthy3.length);
                for (i = 0; i < Unhealthy3.length; i++) {
                    console.log("Unhealthy3: " + Unhealthy3[i]);
                }



                /*
                                          var covered = {
                                          query: {
                                          select: 'geometry',
                                          from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',
                                          where :"DCODE = 3305",
                                        },
                                        map: map,
                                        suppressInfoWindows: true ,
                                        styles: [{
                                        polygonOptions: {
                                        strokeColor: "#ff0000",
                                        fillColor: "#ff0000",
                                      }
                                    }]};*/


                if (good.length > 0 && mModerate.length == 0 && Unhealthy1.length == 0 && Unhealthy2.length == 0 && Unhealthy3.length == 0) {
                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    strokeColor: "#ffffff",
                                    fillColor: "#ffffff",
                                    opacity: .1,


                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }

                if (good.length > 0 && mModerate.length > 0 && Unhealthy1.length == 0 && Unhealthy2.length == 0 && Unhealthy3.length == 0) {
                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    strokeColor: "#ffffff",
                                    fillColor: "#ffffff",
                                    opacity: .1,


                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && mModerate.length > 0 && Unhealthy1.length > 0 && Unhealthy2.length == 0 && Unhealthy3.length == 0) {
                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    strokeColor: "#ffffff",
                                    fillColor: "#ffffff",
                                    opacity: .1,


                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }

                if (good.length > 0 && mModerate.length > 0 && Unhealthy1.length > 0 && Unhealthy2.length > 0 && Unhealthy3.length == 0) {
                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    strokeColor: "#ffffff",
                                    fillColor: "#ffffff",
                                    opacity: .1,


                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && mModerate.length > 0 && Unhealthy1.length > 0 && Unhealthy2.length > 0 && Unhealthy3.length > 0) {
                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    strokeColor: "#ffffff",
                                    fillColor: "#ffffff",
                                    opacity: .1,


                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }



                if (mModerate.length > 0 && good.length == 0 && Unhealthy1.length == 0 && Unhealthy2.length == 0 && Unhealthy3.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,


                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }


                if (Unhealthy1.length > 0 && good.length == 0 && mModerate.length == 0 && Unhealthy2.length == 0 && Unhealthy3.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,


                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }


                if (Unhealthy2.length > 0 && good.length == 0 && mModerate.length == 0 && Unhealthy1.length == 0 && Unhealthy3.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {
                                    //fillColor: getfillColor(aqi),
                                    //strokeColor: getStrokeColor(aqi),
                                    fillColor: "#ffffff",
                                    opacity: .1,


                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    //   fillColor: getfillColor(aqi),
                                    // strokeColor: getStrokeColor(aqi),
                                    fillColor: "#ff944d ",
                                    strokeColor: "#ff944d ",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }

                if (Unhealthy3.length > 0 && good.length == 0 && mModerate.length == 0 && Unhealthy1.length == 0 && Unhealthy2.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && Unhealthy1.length > 0 && mModerate.length == 0 && Unhealthy2.length == 0 && Unhealthy3.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },

                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && Unhealthy2.length > 0 && mModerate.length == 0 && Unhealthy1.length == 0 && Unhealthy3.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },

                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && Unhealthy3.length > 0 && mModerate.length == 0 && Unhealthy1.length == 0 && Unhealthy2.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },

                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (mModerate.length > 0 && Unhealthy1.length > 0 && good.length == 0 && Unhealthy3.length == 0 && Unhealthy2.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },

                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (mModerate.length > 0 && Unhealthy2.length > 0 && good.length == 0 && Unhealthy3.length == 0 && Unhealthy1.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },

                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (mModerate.length > 0 && Unhealthy3.length > 0 && good.length == 0 && Unhealthy2.length == 0 && Unhealthy1.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },

                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (Unhealthy1.length > 0 && Unhealthy2.length > 0 && good.length == 0 && mModerate.length == 0 && Unhealthy3.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },

                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (Unhealthy1.length > 0 && Unhealthy3.length > 0 && good.length == 0 && mModerate.length == 0 && Unhealthy2.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },

                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }

                if (Unhealthy2.length > 0 && Unhealthy3.length > 0 && good.length == 0 && mModerate.length == 0 && Unhealthy1.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },

                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }


                if (good.length > 0 && mModerate.length > 0 && Unhealthy2.length > 0 && Unhealthy3.length == 0 && Unhealthy1.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }


                if (good.length > 0 && mModerate.length > 0 && Unhealthy2.length > 0 && Unhealthy2.length == 0 && Unhealthy1.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }

                if (good.length > 0 && mModerate.length > 0 && Unhealthy3.length > 0 && Unhealthy2.length == 0 && Unhealthy1.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }

                if (good.length > 0 && Unhealthy1.length > 0 && Unhealthy2.length > 0 && mModerate.length == 0 && Unhealthy3.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && Unhealthy1.length > 0 && Unhealthy3.length > 0 && mModerate.length == 0 && Unhealthy2.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && Unhealthy2.length > 0 && Unhealthy3.length > 0 && mModerate.length == 0 && Unhealthy1.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }

                if (mModerate.length > 0 && Unhealthy1.length > 0 && Unhealthy2.length > 0 && good.length == 0 && Unhealthy3.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (mModerate.length > 0 && Unhealthy1.length > 0 && Unhealthy3.length > 0 && good.length == 0 && Unhealthy2.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (Unhealthy1.length > 0 && Unhealthy2.length > 0 && Unhealthy3.length > 0 && good.length == 0 && mModerate.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && mModerate.length > 0 && Unhealthy1.length > 0 && Unhealthy3.length > 0 && Unhealthy2.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && mModerate.length > 0 && Unhealthy1.length > 0 && Unhealthy2.length > 0 && Unhealthy3.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (mModerate.length > 0 && Unhealthy1.length > 0 && Unhealthy2.length > 0 && Unhealthy3.length > 0 && good.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && Unhealthy1.length > 0 && Unhealthy2.length > 0 && Unhealthy3.length > 0 && mModerate.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && mModerate.length > 0 && Unhealthy2.length > 0 && Unhealthy3.length > 0 && Unhealthy1.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy2 + ")",
                                polygonOptions: {
                                    fillColor: "#ff944d",
                                    strokeColor: "#ff944d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }
                if (good.length > 0 && mModerate.length > 0 && Unhealthy1.length > 0 && Unhealthy3.length > 0 && Unhealthy2.length == 0) {

                    var covered = {
                        query: {
                            select: 'geometry',
                            from: '1x40iw0b31K2vTT6ZiSUxBWUfBbznoppAtERA7S2G',

                        },
                        map: map,
                        suppressInfoWindows: true,
                        styles: [{
                                polygonOptions: {

                                    fillColor: "#ffffff",
                                    opacity: .1,

                                }
                            },
                            {
                                where: "SUB_CODE IN (" + good + ")",
                                polygonOptions: {

                                    fillColor: "#4d4dff",
                                    strokeColor: "#4d4dff",
                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + mModerate + ")",
                                polygonOptions: {
                                    fillColor: "#4dff88",
                                    strokeColor: "#4dff88",

                                    strokeWeight: 0.5
                                }
                            },
                            {

                                where: "SUB_CODE IN (" + Unhealthy1 + ")",
                                polygonOptions: {
                                    fillColor: "#ffff4d",
                                    strokeColor: "#ffff4d",
                                    //fillColor: "#ff0000",
                                    // strokeColor: "#ff0000",
                                    strokeWeight: 0.5
                                }
                            },
                            {
                                where: "SUB_CODE IN (" + Unhealthy3 + ")",
                                polygonOptions: {

                                    fillColor: "#ff4d4d",
                                    strokeColor: "#ff4d4d",
                                    strokeWeight: 0.5
                                }
                            }
                        ]
                    };
                }


                var mLayer = new google.maps.FusionTablesLayer(covered);
                FusionTable.push(mLayer);
                console.log("mLayer: " + mLayer);


                var pname = document.getElementById("pname").value;
                console.log("pname: " + pname);




                var infoWindow = new google.maps.InfoWindow({
                    maxWidth: 500
                });

                google.maps.event.addListener(mLayer, 'click', function(ev) {

                    var districtID = parseInt(ev.row['SUB_CODE'].value);
                    var DName = ev.row['DNAME'].value;
                    var SName = ev.row['SNAME'].value;
                    var aqi = Math.max(co[districtID], no2[districtID], o3[districtID], so2[districtID], pm25[districtID]);
                    var content = "<div class = 'text-primary'><b>การแจ้งเตือนสภาพอากาศ</b></div>" +
                        "<div class = 'text-muted'>ค่าเฉลี่ยทั้งวันของวัน " + mDate + "</div>" +
                        "<div class = 'text-info'>" + DName + "</div>" +
                        "<div class = 'text-info'>" + SName + "</div>" +
                        "<div class = 'text-info'>AQI: " + aqi + "</div>" +
                        "<div class = 'text-info'>CO: " + co[districtID] + "</div>" +
                        "<div class = 'text-info'>NO2: " + no2[districtID] + "</div>" +
                        "<div class = 'text-info'>O3: " + o3[districtID] + "</div>" +
                        "<div class = 'text-info'>SO2: " + so2[districtID] + "</div>" +
                        "<div class = 'text-info'>PM2.5: " + pm25[districtID] + "</div>" +
                        "<div class = 'text-info'>ค่ากัมมันตรังสี: " + radio[districtID] + "</div>" +
                        "<button id = 'showGraph' type ='button'  class = 'btn btn-primary btn-sm btn-block' onClick = 'showGraph(" + districtID + ")' >Show Graph</button>";

                    infoWindow.setContent(content);
                    infoWindow.setPosition(ev.latLng);
                    infoWindow.open(map);
                });

                waitingDialog.hide();





            }); //JSON


            $("#dropdownDistrict").empty();
            $("#txtDate").val('');
            //document.getElementById("mDistrict").innerHTML = "District";



        } //setcircle on map


        /*  // Create the legend and display on the map
        var legend = document.createElement('div');
        legend.id = 'legend';
        var content = [];
        content.push('<h3>Air Quality Index</h3>');
        content.push('<p><div class="color blue"></div>0-50 Good</p>');
        content.push('<p><div class="color green"></div>51-100 Moderate</p>');
        content.push('<p><div class="color yellow"></div>100-200 Unhealthy for Sensitive Groups</p>');
        content.push('<p><div class="color orange"></div>201-300 Unhealthy</p>');
        content.push('<p><div class="color red"></div>300+ Very Unhealty</p>');
        legend.innerHTML = content.join('');
        legend.index = 1;
        map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(legend);
        */

    } // init map


    function RemoveMarker() {
        for (i = 0; i < FusionTable.length; i++) {
            FusionTable[i].setMap(null);
            console.log("FusionTable: " + i);
        }
        for (var i = 0; i < KmlLayer.length; i++) {
            KmlLayer[i].setMap(null);
        }


    }




    $(function() {
        var myDate = "";
        var myDistrictID = "";
        var myLineChart;
        $('#txtDate').datetimepicker({
            format: 'DD/MM/YYYY'
        });
        $("#pname").text("กรุงเทพมหานคร");
        document.getElementById("pname").value = "10";
        $("#dname").text("เขตทั้งหมด");
        document.getElementById("dname").value = "2222";
        $("#sname").text("แขวงทั้งหมด");
        document.getElementById("sname").value = "2222";

    }); //function

    function DatePickResponse(dateText) {
        var Day = dateText.substr(0, 2);
        var Month = dateText.substr(3, 2);
        var Year = dateText.substr(6, 7);
        var result = Year + "-" + Month + "-" + Day;
        return result;
    }

    /*  function getDistrictFromLatlng(lat, lng) {
    //  var myLocation = [["13.736623", "100.563866"],["13.757873","100.53623"]];
    //for(i = 0; i<myLocation.length; i++){
    $.getJSON("http://maps.googleapis.com/maps/api/geocode/json?latlng=" + lat + "," + lng + "&sensor=true", function (result) {
    for (j = 0; j < result.results[0].address_components.length; j++) {
    if (result.results[0].address_components[j].long_name.match(/^เขต.*$/)) {
    var myDistrict = result.results[0].address_components[j].long_name
    var mResult = myDistrict.replace("เขต ", "");
    console.log(mResult);
    return mResult;

    }

    }
    });

    //}
    }*/


    function getAQIColor(number) {

        var color;
        if (number > 300) {
            return "#ff4d4d"; //red
        }
        if (number > 200) {
            return "#ff944d"; //orange
        }
        if (number > 100) {
            return "#ffff4d"; //yellow
        }
        if (number > 50) {
            return "#4dff88" //green
        } else {
            return "#4d4dff"; //blue

        }
        return null;
    }

    function getNotification(micon, mtype, mdata) {

        $.notify({
            icon: micon, //icon
            message: mdata //data

        }, {
            type: mtype, //type  danger ,warning ,success ,info
            timer: 2000
        });


    }

    function showGraph(districtID) {

        var date = mydate;
        if (haveChart == true) {
            myLineChart.destroy();
        }
        /*
        var info = "<div class = 'container'><div class='header'><div class = 'row'><div class = 'col-sm-7'><h4 class='title text-primary text-center'><b>Your Selection</b></h4><p class='category text-info text-center'>Choose your range Date</p></div></div></div></div>"
        $("#txtInfo").append(info);*/


        var mytext = "วันที่: " + mydate;
        console.log("mydate4 ID:" + districtID + " date: " + mydate);
        var mDate = DatePickResponse(date);
        var co = [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null];
        var no2 = [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null];
        var o3 = [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null];
        var so2 = [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null];
        var pm25 = [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null];
        var radio = [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null];
        var checkSame2 = [55];

        $.getJSON("http://sysnet.utcc.ac.th/aparcas/api/event_trans.jsp", function(result) {
            var count = 1;
            for (i = 0; i < result.length; i++) {
                var rco = parseInt(result[i].co);
                var rno2 = parseInt(result[i].no2)
                var ro3 = parseInt(result[i].o3);
                var rso2 = parseInt(result[i].so2);
                var rpm25 = parseInt(result[i].pm25);
                var rradio = parseInt(result[i].radio);



                var count2 = new Array(9000).fill(1);

                if (districtID == result[i].grid_id) {

                    var day = moment.unix(result[i].timestamp).format("YYYY-MM-DD HH:mm:ss");

                    var re = new RegExp(mDate, 'g');
                    if (day.match(re)) {



                        var res2 = day.substr(11, 2);
                        if (res2.substr(0, 1) == '0') {
                            res2 = res2.replace('0', '');
                        }

                        var res3 = parseInt(res2);
                        console.log("res3: " + res3);



                        disID = parseInt(result[i].grid_id);




                        for (k = 0; k < checkSame2.length; k++) {
                            if (checkSame2[k] == res3) {



                                console.log("SAMEBefore: " + res3 + " SameCO: " + co[res3] + " SameNo2: " + no2[res3] + " SameO3: " + o3[res3] + " SameSo2: " + so2[res3] + " SamePM25: " + pm25[res3] + " SameRadio: " + radio[res3]);

                                count2[res3] = count2[res3] + 1;
                                co[res3] = (co[res3] + parseInt(result[i].co)) / 2;
                                no2[res3] = (no2[res3] + parseInt(result[i].no2)) / 2;
                                o3[res3] = (o3[res3] + parseInt(result[i].o3)) / 2;
                                so2[res3] = (so2[res3] + parseInt(result[i].so2)) / 2;
                                pm25[res3] = (pm25[res3] + parseInt(result[i].pm25)) / 2;
                                radio[res3] = (radio[res3] + parseInt(result[i].radio)) / 2;




                                console.log("SameAfter: " + res3 + " SameCO: " + co[res3] + " SameNo2: " + no2[res3] + " SameO3: " + o3[res3] + " SameSo2: " + so2[res3] + " SamePM25: " + pm25[res3] + " SameRadio: " + radio[res3]);
                                count = 0;
                                break;

                            }

                        }
                        if (count == 1) {
                            co[res3] = rco;
                            no2[res3] = rno2;
                            o3[res3] = ro3;
                            so2[res3] = rso2;
                            pm25[res3] = rpm25;
                            radio[res3] = rradio;
                            console.log("Time: " + res3 + " CO: " + co[res3] + " No2: " + no2[res3] + " O3: " + o3[res3] + " So2: " + so2[res3] + " PM25: " + pm25[res3] + " Radio: " + radio[res3]);
                            checkSame2.push(res3);
                        }
                        count = 1;



                    } // if time match
                } // if district match
            }


            var mychart = {
                type: 'line',
                data: {
                    labels: ["00.00", "01.00", "02.00", "03.00", "04.00", "05.00", "06.00", "07.00", "08.00", "09.00", "10.00", "11.00", "12.00", "13.00", "14.00", "15.00", "16.00", "17.00", "18.00", "19.00", "20.00", "21.00", "22.00",
                        "23.00"
                    ],
                    datasets: [{
                        label: "CO",
                        data: [
                            co[0], co[1], co[2], co[3], co[4], co[5], co[6], co[7], co[8], co[9], co[10], co[11], co[12], co[13], co[14], co[15], co[16], co[17], co[18], co[19], co[20], co[21], co[22], co[23]
                        ],
                        backgroundColor: window.chartColors.red,
                        borderColor: window.chartColors.red,
                        fill: false,
                        //borderDash: [5, 5],
                        //pointRadius: 15,
                        pointHoverRadius: 10,
                    }, {
                        label: "NO2",
                        data: [
                            no2[0], no2[1], no2[2], no2[3], no2[4], no2[5], no2[6], no2[7], no2[8], no2[9], no2[10], no2[11], no2[12], no2[13], no2[14], no2[15], no2[16], no2[17], no2[18], no2[19], no2[20], no2[21], no2[22],
                            no2[23]

                        ],
                        backgroundColor: window.chartColors.blue,
                        borderColor: window.chartColors.blue,
                        fill: false,
                        pointHoverRadius: 20,
                        //borderDash: [5, 5],
                        //pointRadius: [2, 4, 6, 18, 0, 12, 20],
                    }, {
                        label: "O3",
                        data: [
                            o3[0], o3[1], o3[2], o3[3], o3[4], o3[5], o3[6], o3[7], o3[8], o3[9], o3[10], o3[11], o3[12], o3[13], o3[14], o3[15], o3[16], o3[17], o3[18], o3[19], o3[20], o3[21], o3[22], o3[23]
                        ],
                        backgroundColor: window.chartColors.green,
                        borderColor: window.chartColors.green,
                        fill: false,
                        pointHoverRadius: 20,
                    }, {
                        label: "SO2",
                        data: [
                            so2[0], so2[1], so2[2], so2[3], so2[4], so2[5], so2[6], so2[7], so2[8], so2[9], so2[10], so2[11], so2[12], so2[13], so2[14], so2[15], so2[16], so2[17], so2[18], so2[19], so2[20], so2[21], so2[22],
                            so2[23]

                        ],
                        backgroundColor: window.chartColors.yellow,
                        borderColor: window.chartColors.yellow,
                        fill: false,
                        pointHitRadius: 20,
                    }, {
                        label: "pm2.5",
                        data: [
                            pm25[0], pm25[1], pm25[2], pm25[3], pm25[4], pm25[5], pm25[6], pm25[7], pm25[8], pm25[9], pm25[10], pm25[11], pm25[12], pm25[13], pm25[14], pm25[15], pm25[16], pm25[17], pm25[18], pm25[19], pm25[20],
                            pm25[21], pm25[22], pm25[23]

                        ],
                        backgroundColor: window.chartColors.purple,
                        borderColor: window.chartColors.purple,
                        fill: false,
                        pointHitRadius: 20,
                    }, {
                        label: "Radio",
                        data: [
                            radio[0], radio[1], radio[2], radio[3], radio[4], radio[5], radio[6], radio[7], radio[8], radio[9], radio[10], radio[11], radio[12], radio[13], radio[14], radio[15], radio[16], radio[17], radio[18],
                            radio[19], radio[20], radio[21], radio[22], radio[23]

                        ],
                        backgroundColor: window.chartColors.orange,
                        borderColor: window.chartColors.orange,
                        fill: false,
                        pointHitRadius: 20,
                    }]
                },
                options: {
                    responsive: true,
                    legend: {
                        position: 'bottom',
                    },
                    hover: {
                        mode: 'index'
                    },
                    scales: {
                        xAxes: [{
                            display: true,
                            scaleLabel: {
                                display: true,
                                labelString: '24 ชั่วโมง'
                            }
                        }],
                        yAxes: [{
                            display: true,
                            scaleLabel: {
                                display: true,
                                labelString: 'ค่า'
                            }
                        }]
                    },
                    title: {
                        display: true,
                        text: mytext
                    }
                }
            };
            var ctx = document.getElementById("canvas").getContext("2d");
            myLineChart = new Chart(ctx, mychart);


        });


        haveChart = true;
        $('#myModal').modal('show');

    }


    function getfillColor(number) {

        var color;
        if (number > 300) {
            return "#ff4d4d"; //red
        }
        if (number > 200) {
            return "#ff944d"; //orange
        }
        if (number > 100) {
            return "#ffff4d"; //yellow
        }
        if (number > 50) {
            return "#4dff88" //green
        } else {
            return "#4d4dff"; //blue

        }
        return null;
    }

    function getStrokeColor(number) {


        if (number > 300) {
            return "#ff0000"; //red
        }
        if (number > 200) {
            return "#ff6600"; //orange
        }
        if (number > 100) {
            return "#ffff00"; //yellow
        }
        if (number > 50) {
            return "#00cc00" //green
        } else {
            return "#0066ff"; //blue
        }
        return null;
    }


    $("#clear").click(function() {
        // var select = $('select[name=selectp]').selectpicker();
        // console.log($('select[name=selectp]').val(select));



        RemoveMarker();
        getNotification("pe-7s-smile", "success", "<b>Success</b>");

    });
</script>


<script src="bower_components/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>


<script src="bower_components/bootstrap/dist/js/bootstrap-notify.js"></script>

<script src="bower_components/bootstrap-waitingfor/build/bootstrap-waitingfor.js"></script>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAWgbWYxPgHHo-PU4IuhjjZhjh1PXfhYkc&callback=initMap" type="text/javascript"></script>


</html>
